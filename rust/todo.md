- separate `pick` into `pick_single` and `pick_many`
- create policy lookup-by-id cache to avoid duplicate fetching in `process generated` action, only lookup if cache miss